<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="templateProfesseur" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
  <meta charset="UTF-8">
  <title>Ajouter une note</title>
  <!-- Add Bootstrap CSS link here -->
  <link rel="stylesheet" href="/webjars/bootstrap/5.1.3/css/bootstrap.min.css">
  <script src="/webjars/bootstrap/5.1.3/js/bootstrap.bundle.js"></script>
</head>
<body>
<div class="container" layout:fragment="contentBody">
  <h1>Ajouter une note</h1>

  <form action="/ajouter-note" method="POST">
    <label for="classe">Classe:</label>
    <select id="classe" name="classe">
      <!-- Remplacez les options par les classes associées au professeur -->
      <option value="Dsi21">DSI21</option>
      <option value="Sem21">Sem21</option>
      <option value="Ge11">Ge11</option>
    </select>

    <label for="etudiant">Étudiant:</label>
    <select id="etudiant" name="etudiant">
      <!-- Les étudiants de la classe sélectionnée seront chargés dynamiquement -->
    </select>

    <label for="ds">Note DS:</label>
    <input type="number" id="ds" name="ds" min="0" max="20" step="0.1" required>

    <label for="dc">Note DC:</label>
    <input type="number" id="dc" name="dc" min="0" max="20" step="0.1" required>

    <input type="submit" value="Ajouter la note">
  </form>
</div>
  <script>
    const classeSelect = document.getElementById('classe');
    const etudiantSelect = document.getElementById('etudiant');

    // Événement lorsque la classe est sélectionnée
    classeSelect.addEventListener('change', () => {
      const selectedClasse = classeSelect.value;

      // Appel AJAX pour récupérer les étudiants de la classe sélectionnée
      fetch(`/etudiants?classe=${selectedClasse}`)
              .then(response => response.json())
              .then(data => {
                etudiantSelect.innerHTML = '';

                // Ajouter les options d'étudiant dynamiquement
                data.forEach(etudiant => {
                  const option = document.createElement('option');
                  option.value = etudiant.id;
                  option.text = etudiant.nom;
                  etudiantSelect.appendChild(option);
                });
              });
    });
  </script>

</body>
</html>
